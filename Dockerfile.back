# ---------- build stage ---------- 
FROM node:22-alpine AS builder 

WORKDIR /app 

COPY backend/package*.json ./ 

RUN npm ci 

COPY backend/ . 

RUN npm run build 

# ---------- runtime stage ---------- 
FROM node:22-alpine 

WORKDIR /app 

COPY backend/package*.json ./ 

RUN npm ci --omit=dev 

COPY --from=builder /app/dist ./dist 

EXPOSE 3000 

CMD ["npm", "run", "start:prod"]